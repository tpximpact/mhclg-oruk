name: Enforce staging -> main PRs

on:
  pull_request:
    types: [opened, reopened, synchronize, ready_for_review]
    branches:
      - main

jobs:
  enforce-staging-source:
    name: enforce-staging-source
    runs-on: ubuntu-latest
    steps:
      - name: Fail if PR is not from staging
        run: |
          echo "PR head branch: '${{ github.head_ref }}'"
          if [ "${{ github.head_ref }}" != "staging" ]; then
            echo "This repository requires pull requests to 'main' to originate from the 'staging' branch."
            echo "Please open a PR from the staging branch (merge your changes into staging first)."
            exit 1
          fi
